<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0187: Offline Encrypted Sessions</title><link rel="stylesheet" type="text/css" href="/xmpp.css" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><meta name="DC.Title" content="Offline Encrypted Sessions" /><meta name="DC.Creator" content="Ian Paterson" /><meta name="DC.Description" content="This document specifies an end-to-end encryption protocol for offline XMPP communication sessions." /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2007-05-30" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0187" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright (c) 1999 - 2008 by the XMPP Standards Foundation (XSF)." /></head><body><h1>XEP-0187: Offline Encrypted Sessions</h1><p>This document specifies an end-to-end encryption protocol for offline XMPP communication sessions.</p><hr /><p style="color:red">WARNING: This Standards-Track document is Experimental. Publication as an XMPP Extension Protocol does not imply approval of this proposal by the XMPP Standards Foundation. Implementation of the protocol described herein is encouraged in exploratory implementations, but production systems should not deploy implementations of this protocol until it advances to a status of Draft.</p><hr /><h2>Document Information</h2><p class="indent">
            Series: <a href="http://www.xmpp.org/extensions/">XEP</a><br />
            Number: 0187<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status: 
            <a href="http://www.xmpp.org/extensions/xep-0001.html#states-Experimental">Experimental</a><br />
            Type:
            <a href="http://www.xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br />
            Version: 0.5<br />
            Last Updated: 2007-05-30<br />
                Approving Body: <a href="http://www.xmpp.org/council/">XMPP Council</a><br />Dependencies: XMPP Core, XMPP IM, RFC 2104, RFC 2409, RFC 3526, RFC 3548, xml-c14n, XEP-0004, XEP-0020, XEP-0068, XEP-0079, XEP-0116, XEP-0155, XEP-0163<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: TO BE ASSIGNED<br />
              Wiki Page: &lt;<a href="http://wiki.jabber.org/index.php/Offline Encrypted Sessions (XEP-0187)">http://wiki.jabber.org/index.php/Offline Encrypted Sessions (XEP-0187)</a>&gt;
            </p><hr /><h2>Author Information</h2><div class="indent"><h3>Ian Paterson</h3><p class="indent">
        Email:
        <a href="mailto:ian.paterson@clientside.co.uk">ian.paterson@clientside.co.uk</a><br />
        JabberID: 
        <a href="xmpp:ian@zoofy.com">ian@zoofy.com</a><br /></p></div><hr /><h2>Legal Notices</h2><div class="indent"><h3>Copyright</h3>This XMPP Extension Protocol is copyright (c) 1999 - 2008 by the XMPP Standards Foundation (XSF).<h3>Permissions</h3>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h3>Disclaimer of Warranty</h3><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. In no event shall the XMPP Standards Foundation or the authors of this Specification be liable for any claim, damages, or other liability, whether in an action of contract, tort, or otherwise, arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification. ##</span><h3>Limitation of Liability</h3>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising out of the use or inability to use the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h3>IPR Conformance</h3>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which may be found at &lt;<a href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt; or obtained by writing to XSF, P.O. Box 1641, Denver, CO 80201 USA).</div><hr /><h2>Discussion Venue</h2><p class="indent">The preferred venue for discussion of this document is the Standards discussion list: &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">http://mail.jabber.org/mailman/listinfo/standards</a>&gt;.</p><p class="indent">Given that this XMPP Extension Protocol normatively references IETF technologies, discussion on the XSF-IETF list may also be appropriate (see &lt;<a href="http://mail.jabber.org/mailman/listinfo/jsf-ietf">http://mail.jabber.org/mailman/listinfo/jsf-ietf</a>&gt; for details).</p><p class="indent">Errata may be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><h2>Relation to XMPP</h2><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 3920) and XMPP IM (RFC 3921) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><h2>Conformance Terms</h2><p class="indent">The following keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#intro">Introduction</a><br />2.  <a href="#personae">Dramatis Personae</a><br />3.  <a href="#init">Offline ESession Negotiation</a><br />   
      3.1.  <a href="#init-offline-publish">Publishing Offline ESession Options</a><br />   
      3.2.  <a href="#init-offline-request">Requesting Offline ESession Options</a><br />   
      3.3.  <a href="#init-offline-start">Starting an Offline ESession</a><br />   
      3.4.  <a href="#init-offline-accept">Accepting Offline ESessions</a><br />4.  <a href="#exchange">Exchanging Stanzas</a><br />5.  <a href="#terminate">ESession Termination</a><br />6.  <a href="#sec">Security Considerations</a><br />   
      6.1.  <a href="#sec-replay">Replay Attacks</a><br />   
      6.2.  <a href="#sec-expire">Options Expiry Time</a><br />   
      6.3.  <a href="#sec-identity">Identity Protection</a><br />   
      6.4.  <a href="#sec-conclusion">Conclusion</a><br />7.  <a href="#iana">IANA Considerations</a><br />8.  <a href="#registrar">XMPP Registrar Considerations</a><br />   
      8.1.  <a href="#ns">Protocol Namespaces</a><br /><a href="#notes">Notes</a><br /><a href="#revs">Revision History</a></p></div><hr /><h2>1.
       <a name="intro" id="intro">Introduction</a></h2>
  <p class="" style="">The convenience of sending stanzas to other entities that are offline ("offline messages") is an important and popular feature of most XMPP implementations (see <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0160.html">Best Practices for Handling Offline Messages</a></span>  [<a href="#nt-id2252679">1</a>]). Without offline messages delivery would have to wait until both entities managed to be online at the same time. So many urgent messages could not be delivered in time. For example, the sender might want to send an urgent message before jumping on a flight.</p>
  <p class="" style="">End-to-end encryption is another desirable feature for any communication technology. Unfortunately it is not possible to make offline encryption quite so secure as online encryption (see <a href="#sec">Security Considerations</a>). However, offline encryption has a long history and is certainly preferable to having no encryption at all.  [<a href="#nt-id2252703">2</a>] Unfortunately, for reasons described in <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0188.html">Cryptographic Design of Encrypted Sessions</a></span>  [<a href="#nt-id2252736">3</a>], the existing proposals (including <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0027.html">Current Jabber OpenPGP Usage</a></span>  [<a href="#nt-id2251320">4</a>] and <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc3923">RFC 3923</a></span>  [<a href="#nt-id2251342">5</a>]) have not been widely implemented and deployed. This document describes a different approach to offline end-to-end encryption for use by entities that communicate using XMPP. It builds on the existing online <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0116.html">Encrypted Session Negotiation</a></span>  [<a href="#nt-id2251367">6</a>] protocol. As a result it offers important advantages over the existing "Object Encryption" proposals:</p>
  <ul class="" style="">
    <li class="" style="">Perfect Forward Secrecy  [<a href="#nt-id2251525">7</a>]</li>
    <li class="" style="">Other security features described in <span class="ref">Cryptographic Design of Encrypted Sessions</span></li>
    <li class="" style="">Most of the code can be borrowed from implementations of <span class="ref">Encrypted Session Negotiation</span></li>
  </ul>
  <p class="" style="">The requirements and the consequent cryptographic design that underpin this protocol are described in <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0210.html">Requirements for Encrypted Sessions</a></span>  [<a href="#nt-id2251590">8</a>] and <span class="ref">Cryptographic Design of Encrypted Sessions</span>. The basic concept is that of an encrypted session which acts as a secure tunnel between the online endpoint and the offline endpoint. The offline endpoint completes its part of the tunnel "negotiation" by publishing its preferences before it goes offline. Once the tunnel is established by the online endpoint, the content of each one-to-one XML stanza sent by the online endpoint is encrypted and then transmitted within a "wrapper" stanza using <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0200.html">Stanza Encryption</a></span>  [<a href="#nt-id2251407">9</a>].</p>
<h2>2.
       <a name="personae" id="personae">Dramatis Personae</a></h2>
  <p class="" style="">This document introduces two characters to help the reader follow the necessary exchanges:</p>
  <ol start="1" class="" style="">
    <li class="" style="">"Bob" is the name of the online participant in the offline ESession. Within the scope of this document, his fully-qualified JID is: &lt;bob@example.com/laptop&gt;.</li>
    <li class="" style="">"Alice" is the name of the offline participant in the offline ESession started by Bob. Within the scope of this document, we stipulate that her fully-qualified JID is: &lt;alice@example.org/pda&gt;.</li>
  </ol>
  <p class="" style="">While Bob and Alice are introduced as "end users", they are simply meant to be examples of Jabber entities. Any directly addressable Jabber entity may participate in an offline ESession.</p>
<h2>3.
       <a name="init" id="init">Offline ESession Negotiation</a></h2>
  <p class="" style="">The approach to establishing a secure session with an entity that is offline is in essence a special case of 3-message negotiation employed for online ESessions (see <span class="ref">Encrypted Session Negotiation</span>).</p>
  <p class="" style="">Alice MAY publish a set of offline ESession options just before she goes offline. If Bob subscribes to Alice's presence and wishes to establish an online ESession with her, but he finds that she is offline, then if she published her offline ESession options before going offline, he may use the protocol described below to perform the initial Diffie-Hellman key exchange, establish an offline ESession and send encrypted stanzas to her while she is offline. Note: Bob MUST NOT initiate a new ESession with Alice if he already has an ESession established with her.</p>
  <p class="" style="">Note: Alice MAY also publish <span class="em">another</span> similar set of relatively long-lived  [<a href="#nt-id2251513">10</a>] offline ESession options that any entity MAY use for the same purpose.</p>

    <div class="indent"><h3>3.1 <a name="init-offline-publish" id="init-offline-publish">Publishing Offline ESession Options</a></h3>
      <p class="" style="">In order to publish either set of her offline ESession options Alice MUST create an options data form in exactly the same way as she would create an online ESession request data form (see the ESession Request section in <span class="ref">Encrypted Session Negotiation</span>) except she MUST omit The 'accept' and 'pubkey' fields. Note: The list of stanza types she is willing to decrypt MUST NOT include the value 'iq'.</p>
      <p class="" style="">Alice MUST append to the content of the form an 'expires' field containing the UTC time (see <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0082.html">XMPP Date and Time Profiles</a></span>  [<a href="#nt-id2261108">11</a>]) that she decides her offline ESession options will expire (see <a href="#sec-expire">Options Expiry Time</a> Security Considerations).</p>
      <p class="" style="">Alice MUST store her value of N<span class="sub" style="">A</span> (her ESession ID), all her values of x (one for each MODP group) and the time she decides her offline ESession options will expire in a secure way, so that she can retrieve them when she comes back online (idealy even if that is using a different client and/or a different machine).</p>
      <p class="" style="">If Alice would not be able to decrypt stanzas if she came back online using a different client and/or a different machine then she SHOULD also encapsulate the resource of her client in a 'match_resource' field and append it to her options data form. In this case, the list of stanza types she is willing to decrypt MUST include only 'message'.</p>
      <p class="" style="">Alice MUST also append to the content of the form a list of signatures (see <a href="#sign">Signature Generation</a>) of the <span class="em">content</span> of the data form (excluding the 'signs' field). The list SHOULD include one signature for each of the public signature-verification keys that other entities may use to authenticate her.</p>
      <p class="" style="">Alice MUST publish the ESession options data form through her own server using <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0163.html">Personal Eventing via Pubsub</a></span>  [<a href="#nt-id2261206">12</a>].</p>
      <p class="" style="">If the pubkey PEP node does not exist already then Alice MUST create it first. In this case, Alice SHOULD specify the "Presence" access model for the set of options for presence subscribers (or the "Open" model for the set for other entities), unless she wants greater control over access to her identity (see <a href="#sec-identity">Identity Protection</a> Security Considerations). Alice SHOULD specify that the options will never be pushed to subscribers (even when she publishes new options) - especially if she specifies the "Whitelist" access model.</p>
  <p class="caption"><a name="example-1" id="example-1"></a>Example 1. Alice Creates PEP Node for ESession Options for Presence Subscribers</p><div class="indent"><pre>
&lt;iq from='alice@example.org/pda' type='set' id='create1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;create node='http://www.xmpp.org/extensions/xep-0187.html#ns'/&gt;
    &lt;configure&gt;
      &lt;x xmlns='jabber:x:data' type='form'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
          &lt;value&gt;http://jabber.org/protocol/pubsub#node_config&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#deliver_notifications'&gt;
          &lt;option&gt;&lt;value&gt;0&lt;/value&gt;&lt;/option&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#send_last_published_item'&gt;
          &lt;option&gt;&lt;value&gt;never&lt;/value&gt;&lt;/option&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#access_model'&gt;
          &lt;option&gt;&lt;value&gt;presence&lt;/value&gt;&lt;/option&gt;
        &lt;/field&gt;
      &lt;/x&gt;
    &lt;/configure&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="caption"><a name="example-2" id="example-2"></a>Example 2. Alice Creates PEP Node for ESession Options for All Entities</p><div class="indent"><pre>
&lt;iq from='alice@example.org/pda' type='set' id='create2'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;create node='http://www.xmpp.org/extensions/xep-0116.html#ns'/&gt;
    &lt;configure&gt;
      &lt;x xmlns='jabber:x:data' type='form'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
          &lt;value&gt;http://jabber.org/protocol/pubsub#node_config&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#deliver_notifications'&gt;
          &lt;option&gt;&lt;value&gt;0&lt;/value&gt;&lt;/option&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#send_last_published_item'&gt;
          &lt;option&gt;&lt;value&gt;never&lt;/value&gt;&lt;/option&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#access_model'&gt;
          &lt;option&gt;&lt;value&gt;open&lt;/value&gt;&lt;/option&gt;
        &lt;/field&gt;
      &lt;/x&gt;
    &lt;/configure&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="" style="">Once the publishing node has been created, Alice can update her options for subscribers to her presence whenever she goes offline:</p>
  <p class="caption"><a name="example-3" id="example-3"></a>Example 3. Alice Publishes Her ESession Options for Her Presence Subscribers</p><div class="indent"><pre>
&lt;iq from='alice@example.org/pda' type='set' id='pub1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;publish node='http://www.xmpp.org/extensions/xep-0187.html#ns'&gt;
      &lt;item&gt;
        &lt;x type='form' xmlns='jabber:x:data'&gt;
          &lt;field type="hidden" var="FORM_TYPE"&gt;
            &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
          &lt;/field&gt;
          &lt;field type="list-single" var="otr"&gt;
            &lt;option&gt;&lt;value&gt;false&lt;/value&gt;&lt;/option&gt;
            &lt;option&gt;&lt;value&gt;true&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="list-single" var="disclosure"&gt;
            &lt;option&gt;&lt;value&gt;never&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="list-single" var="security"&gt;
            &lt;option&gt;&lt;value&gt;e2e&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="list-single" var="modp"&gt;
            &lt;option&gt;&lt;value&gt;5&lt;/value&gt;&lt;/option&gt;
            &lt;option&gt;&lt;value&gt;14&lt;/value&gt;&lt;/option&gt;
            &lt;option&gt;&lt;value&gt;2&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="list-single" var="crypt_algs"&gt;
            &lt;option&gt;&lt;value&gt;aes256-ctr&lt;/value&gt;&lt;/option&gt;
            &lt;option&gt;&lt;value&gt;twofish256-ctr&lt;/value&gt;&lt;/option&gt;
            &lt;option&gt;&lt;value&gt;aes128-ctr&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="list-single" var="hash_algs"&gt;
            &lt;option&gt;&lt;value&gt;whirlpool&lt;/value&gt;&lt;/option&gt;
            &lt;option&gt;&lt;value&gt;sha256&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="list-single" var="sign_algs"&gt;
            &lt;option&gt;&lt;value&gt;rsa&lt;/value&gt;&lt;/option&gt;
            &lt;option&gt;&lt;value&gt;dsa&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="list-single" var="compress"&gt;
            &lt;option&gt;&lt;value&gt;none&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="list-multi" var="stanzas"&gt;
            &lt;option&gt;&lt;value&gt;message&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="list-single" var="ver"&gt;
            &lt;option&gt;&lt;value&gt;1.3&lt;/value&gt;&lt;/option&gt;
            &lt;option&gt;&lt;value&gt;1.2&lt;/value&gt;&lt;/option&gt;
          &lt;/field&gt;
          &lt;field type="text-single" var="rekey_freq"&gt;
            &lt;value&gt;1&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var="expires"&gt;
            &lt;value&gt;2006-06-09T02:56:15Z&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var="my_nonce"&gt;
            &lt;value&gt; ** Base64 encoded ESession ID ** &lt;/value&gt;
          &lt;/field&gt;
          &lt;field var="dhkeys"&gt;
            &lt;value&gt; ** Base64 encoded value of e5 ** &lt;/value&gt;
            &lt;value&gt; ** Base64 encoded value of e14 ** &lt;/value&gt;
            &lt;value&gt; ** Base64 encoded value of e2 ** &lt;/value&gt;
          &lt;/field&gt;
          &lt;field var="match_resource"&gt;
            &lt;value&gt;pda&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var="signs"&gt;
            &lt;value&gt; ** signature of form ** &lt;/value&gt;
            &lt;value&gt; ** signature of form ** &lt;/value&gt;
          &lt;/field&gt;
        &lt;/x&gt;
      &lt;/item&gt;
    &lt;/publish&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="" style="">At the risk of divulging her presence, Alice MAY also update her options for all entities:</p>
  <p class="caption"><a name="example-4" id="example-4"></a>Example 4. Alice Publishes Her ESession Options for All Entities</p><div class="indent"><pre>
&lt;iq type='set' from='alice@example.org/pda' id='pub2'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;publish node='http://www.xmpp.org/extensions/xep-0116.html#ns'&gt;
      ...
    &lt;/publish&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
  </pre></div>
    </div>
    <div class="indent"><h3>3.2 <a name="init-offline-request" id="init-offline-request">Requesting Offline ESession Options</a></h3>
      <p class="" style="">If Bob believes Alice is offline he SHOULD request her ESession options and, if he does not have a local copy of any of her public keys, her long-term public signature-verification keys from her server using <span class="ref">Personal Eventing via Pubsub</span> (see <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0189.html">Public Key Publishing</a></span>  [<a href="#nt-id2251043">13</a>]).  [<a href="#nt-id2251178">14</a>]</p>
      <p class="" style="">If Bob is subscribing to Alice's presence he MUST request her ESession Options exclusively for subscribers.</p>
      <p class="caption"><a name="example-5" id="example-5"></a>Example 5. Bob asks Alice's Server for her ESession Options (Subscribers)</p><div class="indent"><pre>
&lt;iq type='get'
    from='bob@example.com/laptop'
    to='alice@example.org'
    id='es4'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;items node='http://www.xmpp.org/extensions/xep-0187.html#ns'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
  </pre></div>
      <p class="" style="">If Bob is not subscribing to Alice's presence (or if Alice has no ESession options exclusively for subscribers) he MUST use the following request instead.</p>
      <p class="caption"><a name="example-6" id="example-6"></a>Example 6. Bob asks Alice's Server for her ESession Options (All Entities)</p><div class="indent"><pre>
&lt;iq type='get'
    from='bob@example.com/laptop'
    to='alice@example.org'
    id='es4'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;items node='http://www.xmpp.org/extensions/xep-0116.html#ns'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
  </pre></div>
      <p class="" style="">If, after receiving Alice's offline ESession options, Bob is unable to verify any of Alice's signatures of her options data form (see <a href="#sign">Signature Verification</a>) with any of her public keys already in his possession (or with any of her keys he is able to acquire and trust) then he MUST proceed no further, since he cannot be sure who will be able to decrypt his stanzas.</p>
      <p class="" style="">If Bob cannot acquire Alice's ESession options, or he does not support one or more of the options in each Alice's ESession fields, or if the 'expires' field indicates that Alice's options have expired, then he MUST NOT send encrypted stanzas to her while she is offline.</p>
    </div>

    <div class="indent"><h3>3.3 <a name="init-offline-start" id="init-offline-start">Starting an Offline ESession</a></h3>
      <p class="" style="">Bob MUST now continue as if Alice had requested an online ESession, performing the steps described in three of the sections of <span class="ref">Encrypted Session Negotiation</span>:</p>
      <ol start="1" class="" style="">
        <li class="" style=""><p class="" style=""><span class="ref">Diffie-Hellman Preparation (Bob)</span> Note: If the value of e he selected is not valid, Bob SHOULD terminate the ESession <span class="em">without</span> sending an error.</p></li>
        <li class="" style=""><p class="" style=""><span class="ref">Generating Session Keys</span></p></li>
        <li class="" style=""><p class="" style=""><span class="ref">Hiding Identity</span> Note: Since Bob did not receive a 'pubkey' field, he MUST assume its value is 'key'. Bob SHOULD NOT include a 'pubkey' field in form<span class="sub" style="">B</span> since Alice has already 'proved' her identity.</p></li>
      </ol>
      <p class="" style="">As with 3-message ESession negotiation, Bob should encapsulate the Base64 encoded values of ID<span class="sub" style="">B</span> and M<span class="sub" style="">B</span> in data form fields ('identity' and 'mac'), and append the new fields to form<span class="sub" style="">B</span>.</p>
      <p class="" style="">Bob MAY also send encrypted content (see the Exchanging Stanzas section of <span class="ref">Encrypted Session Negotiation</span>) in the same stanza. Note: If he also includes a field named "terminate" set to a value of "1" or "true" within the data form (see the ESession Termination section of <span class="ref">Encrypted Session Negotiation</span>) then the ESession is terminated immediately. This special case, where a single stanza is encrypted and sent in isolation, is equivalent to object encryption (or object signing if no encryption is specified) and offers several significant advantages over non-session approaches - including perfect forward secrecy.</p>
      <p class="" style="">If Alice included a 'match_resource' field in her ESession options, then Bob MUST address all the stanzas he sends within the offline ESession to the specified resource and use the <span class="ref">Advanced Message Processing</span> protocol to ensure that they are not delivered to any other resource.</p>
      <p class="" style="">After sending form<span class="sub" style="">B</span> to Alice, Bob can assume that the ESession negotiation is complete.</p>
      <p class="caption"><a name="example-7" id="example-7"></a>Example 7. Bob Establishes an ESession Without Negotiation</p><div class="indent"><pre>
&lt;message from='bob@example.com/laptop' to='alice@example.org/pda' type='chat'&gt;
  &lt;init xmlns='http://www.xmpp.org/extensions/xep-0116.html#ns-init'&gt;
    &lt;x type='submit' xmlns='jabber:x:data'&gt;
      &lt;field var="FORM_TYPE"&gt;
        &lt;value&gt;urn:xmpp:ssn&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var="otr"&gt;&lt;value&gt;true&lt;/value&gt;&lt;/field&gt;
      &lt;field var="disclosure"&gt;&lt;value&gt;never&lt;/value&gt;&lt;/field&gt;
      &lt;field var="security"&gt;&lt;value&gt;e2e&lt;/value&gt;&lt;/field&gt;
      &lt;field var="modp"&gt;&lt;value&gt;5&lt;/value&gt;&lt;/field&gt;
      &lt;field var="crypt_algs"&gt;&lt;value&gt;aes256-ctr&lt;/value&gt;&lt;/field&gt;
      &lt;field var="hash_algs"&gt;&lt;value&gt;sha256&lt;/value&gt;&lt;/field&gt;
      &lt;field var="sign_algs"&gt;&lt;value&gt;rsa&lt;/value&gt;&lt;/field&gt;
      &lt;field var="compress"&gt;&lt;value&gt;none&lt;/value&gt;&lt;/field&gt;
      &lt;field var="stanzas"&gt;&lt;value&gt;message&lt;/value&gt;&lt;/field&gt;
      &lt;field var="ver"&gt;&lt;value&gt;1.3&lt;/value&gt;&lt;/field&gt;
      &lt;field var="rekey_freq"&gt;&lt;value&gt;50&lt;/value&gt;&lt;/field&gt;
      &lt;field var="my_nonce"&gt;
        &lt;value&gt; ** Base64 encoded ESession ID ** &lt;/value&gt;
      &lt;/field&gt;
      &lt;field var="dhkeys"&gt;
        &lt;value&gt; ** Base64 encoded value of d ** &lt;/value&gt;
      &lt;/field&gt;
      &lt;field var="nonce"&gt;
        &lt;value&gt; ** Base64 encoded ESession ID ** &lt;/value&gt;
      &lt;/field&gt;
      &lt;field var="counter"&gt;
        &lt;value&gt; ** Base64 encoded block counter ** &lt;/value&gt;
      &lt;/field&gt;
      &lt;field var="identity"&gt;
        &lt;value&gt; ** Encrypted identity ** &lt;/value&gt;
      &lt;/field&gt;
      &lt;field var="mac"&gt;
        &lt;value&gt; ** Integrity of identity ** &lt;/value&gt;
      &lt;/field&gt;
    &lt;/x&gt;
  &lt;/init&gt;
  &lt;c xmlns='http://www.xmpp.org/extensions/xep-0200.html#ns'&gt;
    &lt;data&gt; ** Base64 encoded m_final ** &lt;/data&gt;
    &lt;mac&gt; ** Base64 encoded a_mac ** &lt;/mac&gt;
  &lt;/c&gt;
  &lt;amp xmlns='http://jabber.org/protocol/amp'&gt;
    &lt;rule action='??????' condition='match-resource' value='exact'/&gt;
  &lt;/amp&gt;
&lt;/message&gt;
    </pre></div>
    </div>
    <div class="indent"><h3>3.4 <a name="init-offline-accept" id="init-offline-accept">Accepting Offline ESessions</a></h3>
      <p class="" style="">When Alice comes online she MUST perform the following steps:</p>
      <ol start="" class="" style="">
        <li class="" style=""><p class="" style="">Ensure she is no longer publishing offline ESession options exclusively for entities that are subscribing to her presence.</p>
            <p class="caption"><a name="example-8" id="example-8"></a>Example 8. Alice Stops Publishing Her ESession Options</p><div class="indent"><pre>
&lt;iq type='set' from='alice@example.org/pda' id='es5'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;publish node='http://www.xmpp.org/extensions/xep-0187.html#ns'&gt;
      &lt;item/&gt;
    &lt;/publish&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
  </pre></div>
        </li>
        <li class="" style=""><p class="" style="">Retrieve any values of N<span class="sub" style="">A</span>, x (one for each MODP group for each N<span class="sub" style="">A</span>) and her offline ESession options expiry time that she stored before going offline, and destroy in a secure way any persistently stored copies that correspond to ESession options exclusively for subscribers.</p></li>
      </ol>
      <p class="" style="">If the current time is after her offline ESession options expiry time then she MUST discard all stanzas from offline ESessions without decrypting them. Otherwise, when Alice receives an offline ESession request stanza from Bob then she MUST perform the following steps:</p>
      <ol start="" class="" style="">
        <li class="" style=""><p class="" style="">Select her value of x that corresponds to the 'nonce' and 'modp' fields she received from Bob.  [<a href="#nt-id2261967">16</a>]</p></li>
        <li class="" style=""><p class="" style="">Confirm that she has not already received a key exchange stanza from Bob with the same value of d or N<span class="sub" style="">B</span> ('my_nonce' field) since she published her ESession options (see the Replay Attacks subsection of the Security Considerations section of <span class="ref">Encrypted Session Negotiation</span>). If the options were for subscribers, that means since she came online.</p></li>
        <li class="" style=""><p class="" style="">Alice MUST now continue as if Bob had responded to her online ESession request, performing the steps described in two of the sections of <span class="ref">Encrypted Session Negotiation</span>:</p>
        <ul class="" style="">
          <li class="" style=""><p class="" style=""><span class="ref">Diffie-Hellman Preparation (Alice)</span> Note: If she is not prepared to support any of the ESession options specified by Bob, or if the value of d she selected is not valid, then Alice SHOULD terminate the ESession <span class="em">without</span> sending an error.</p></li>
          <li class="" style=""><p class="" style=""><span class="ref">Verifying Bob's Identity</span> Note: Since Alice did not send a 'pubkey' field to Bob, she MUST assume its value is 'key'. If the value of M<span class="sub" style="">B</span> she calculated does not match the one she received, or if she cannot confirm that pubKey<span class="sub" style="">B</span> really is Bob's public key, or if she cannot confirm that sign<span class="sub" style="">B</span> is the signature of the HMAC result, then Alice SHOULD terminate the ESession <span class="em">without</span> sending an error.</p></li>
        </ul></li>
      </ol>
    </div>
<h2>4.
       <a name="exchange" id="exchange">Exchanging Stanzas</a></h2>
  <p class="" style="">Alice MUST NOT send encrypted content within an offline ESession started by Bob. If Bob is conducting an offline ESession with Alice when she is online (e.g., if he is not subscribing to her presence), then if Alice wants to send a stanza to Bob, she MUST terminate the offline ESession and start a new online ESession first.</p>
  <p class="" style="">For Offline ESessions, Bob SHOULD include a 'Created' SHIM header in the encrypted content. Assuming she trusts Bob, Alice SHOULD trust this header and ignore the unencrypted <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0091.html">Delayed Delivery</a></span>  [<a href="#nt-id2262150">17</a>] element inserted by her server.</p>
  <p class="caption"><a name="example-9" id="example-9"></a>Example 9. Unencrypted Stanza</p><div class="indent"><pre>
&lt;message from='bob@example.com/laptop'
         to='alice@example.org/pda'
         type='chat'&gt;
  &lt;body&gt;Hello, Alice!&lt;/body&gt;
  &lt;amp xmlns='http://jabber.org/protocol/amp'&gt;
    &lt;rule action='error' condition='match-resource' value='exact'/&gt;
  &lt;/amp&gt;
  &lt;headers xmlns='http://jabber.org/protocol/shim'&gt;
    &lt;header name='Created'&gt;2005-02-10T03:01:52Z&lt;/header&gt;
  &lt;/headers&gt;
  &lt;active xmlns='http://jabber.org/protocol/chatstates'/&gt;
&lt;/message&gt;
</pre></div>
  <p class="caption"><a name="example-10" id="example-10"></a>Example 10. XML Content to be Encrypted</p><div class="indent"><pre>
&lt;body&gt;Hello, Alice!&lt;/body&gt;
&lt;headers xmlns='http://jabber.org/protocol/shim'&gt;
  &lt;header name='Created'&gt;2005-02-10T03:01:52Z&lt;/header&gt;
&lt;/headers&gt;
&lt;active xmlns='http://jabber.org/protocol/chatstates'/&gt;
  </pre></div>
<h2>5.
       <a name="terminate" id="terminate">ESession Termination</a></h2>
  <p class="" style="">If Bob notices that Alice comes online during his offline ESession with her then he MUST terminate the ESession immediately. If required he may then negotiate a new (more secure) online ESession.</p>
  <p class="" style="">When Alice receives the offline ESession termination stanza from Bob, she SHOULD NOT send a termination stanza back to him.</p>
<h2>6.
       <a name="sec" id="sec">Security Considerations</a></h2>
  <p class="" style="">For more security considerations refer to the Security Considerations section of <span class="ref">Encrypted Session Negotiation</span></p>
  <div class="indent"><h3>6.1 <a name="sec-replay" id="sec-replay">Replay Attacks</a></h3>
    <p class="" style="">Since Alice supplies the same set of values of e for all offline ESessions, to prevent complete offline ESessions being replayed to her, she MUST take care to securely store <span class="em">new</span> values (or destroy existing values) of N<span class="sub" style="">A</span> and x for subscribers whenever she goes offline (see <a href="#init-publish">Publishing ESession Options</a>). Also, when Alice comes online again, she MUST remember all the values of d he receives in offline ESession negotiation stanzas, and reject any offline ESessions that specify a value of d she has already received (see <a href="#init-accept">Accepting an Offline ESession</a>).</p>
    <p class="" style="">Note: If Alice publishes ESession options for non-subscribers, and if she does not update them whenever she comes online then, until she updates the options, she MUST save all the values of d she receives to secure persistent storage (along with the values of N<span class="sub" style="">A</span> and x).</p>
  </div>
  <div class="indent"><h3>6.2 <a name="sec-expire" id="sec-expire">Options Expiry Time</a></h3>
    <p class="" style="">If Alice's offline private Diffie-Hellman keys are compromised before she destroys them, and the attacker also controls communications between Bob and Alice's server, then the attacker could prevent Bob discovering if she comes online, and resend her compromised ESession options to Bob whenever he asks for them. This would allow the attacker to decrypt all messages sent to Alice before her offline ESession options expire. Alice would probably never receive the messages sent to her after she comes back online. If an attack is discovered before the compromised ESession options expire then Alice SHOULD change her long-term signing key. Alice SHOULD mitigate this attack by choosing an expiry time for her ESession options that is not too long after she expects to be online again.</p>
  </div>
  <div class="indent"><h3>6.3 <a name="sec-identity" id="sec-identity">Identity Protection</a></h3>
    <p class="" style="">Alice's Offline ESession options include her signatures. Although the signatures are public information, any entity that possesses one of Alice's corresponding public keys may confirm whether or not she is the entity using the JID. If it is important for Alice to protect her identity (i.e. hide the fact that she is the user of the JID), then she MUST carefully control who has access to her public keys.</p>
  </div>
  <div class="indent"><h3>6.4 <a name="sec-conclusion" id="sec-conclusion">Conclusion</a></h3>
    <p class="" style="">In addition to the issues above, the Perfect Forward Secrecy window of vulnerability is longer. More seriously, Alice MUST store her private Diffie-Hellman keys, x<span class="sub" style="">1</span>...x<span class="sub" style="">Z</span>, to local disk or to a server (perhaps symmetrically encrypted with a password). It is <span class="em">really</span> hard to securely erase something from a disk. Note: Once compromised, her private Diffie-Hellman keys could only be used to decrypt messages sent to her within offline Esessions until her offline ESession options expire. They could not be used to negotiate online ESessions  [<a href="#nt-id2262363">18</a>], or to send messages that appear to be from Alice. This is a significant benefit when compared to the existing "object encryption" schemes.</p>
    <p class="" style="">Alice could decide not to support Offline ESessions since they are less secure than online ESessions. However, if Alice does that then, while she is offline, Bob, or Aunt Tillie, will probably send her completely unprotected messages!</p>
  </div>
<h2>7.
       <a name="iana" id="iana">IANA Considerations</a></h2>
  <p class="" style="">This document requires no interaction with the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-id2262452">19</a>].</p>
<h2>8.
       <a name="registrar" id="registrar">XMPP Registrar Considerations</a></h2>
  <div class="indent"><h3>8.1 <a name="ns" id="ns">Protocol Namespaces</a></h3>
    <p class="" style="">Until this specification advances to a status of Draft, its associated namespace shall be "http://www.xmpp.org/extensions/xep-0187.html#ns"; upon advancement of this specification, the <span class="ref" style=""><a href="http://www.xmpp.org/registrar/">XMPP Registrar</a></span>  [<a href="#nt-id2262541">20</a>] shall issue a permanent namespace in accordance with the process defined in Section 4 of <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0053.html">XMPP Registrar Function</a></span>  [<a href="#nt-id2262522">21</a>].</p>
  </div>
<hr /><h2><a name="notes" id="notes"></a>Notes</h2><div class="indent"><p><a name="nt-id2252679" id="nt-id2252679">1</a>. XEP-0160: Best Practices for Handling Offline Messages &lt;<a href="http://www.xmpp.org/extensions/xep-0160.html">http://www.xmpp.org/extensions/xep-0160.html</a>&gt;.</p><p><a name="nt-id2252703" id="nt-id2252703">2</a>. This protocol does not stop paranoid users avoiding sending offline messages.</p><p><a name="nt-id2252736" id="nt-id2252736">3</a>. XEP-0188: Cryptographic Design of Encrypted Sessions &lt;<a href="http://www.xmpp.org/extensions/xep-0188.html">http://www.xmpp.org/extensions/xep-0188.html</a>&gt;.</p><p><a name="nt-id2251320" id="nt-id2251320">4</a>. XEP-0027: Current Jabber OpenPGP Usage &lt;<a href="http://www.xmpp.org/extensions/xep-0027.html">http://www.xmpp.org/extensions/xep-0027.html</a>&gt;.</p><p><a name="nt-id2251342" id="nt-id2251342">5</a>. RFC 3923: End-to-End Signing and Object Encryption for the Extensible Messaging and Presence Protocol (XMPP) &lt;<a href="http://tools.ietf.org/html/rfc3923">http://tools.ietf.org/html/rfc3923</a>&gt;.</p><p><a name="nt-id2251367" id="nt-id2251367">6</a>. XEP-0116: Encrypted Session Negotiation &lt;<a href="http://www.xmpp.org/extensions/xep-0116.html">http://www.xmpp.org/extensions/xep-0116.html</a>&gt;.</p><p><a name="nt-id2251525" id="nt-id2251525">7</a>. Long-lived keys are typically used for a few years, whereas Offline ESession decryption keys typically exist for just a few hours. So the Perfect Forward Secrecy feature significantly enhances the security of Offline ESessions.</p><p><a name="nt-id2251590" id="nt-id2251590">8</a>. XEP-0210: Requirements for Encrypted Sessions &lt;<a href="http://www.xmpp.org/extensions/xep-0210.html">http://www.xmpp.org/extensions/xep-0210.html</a>&gt;.</p><p><a name="nt-id2251407" id="nt-id2251407">9</a>. XEP-0200: Stanza Encryption &lt;<a href="http://www.xmpp.org/extensions/xep-0200.html">http://www.xmpp.org/extensions/xep-0200.html</a>&gt;.</p><p><a name="nt-id2251513" id="nt-id2251513">10</a>. The more often Alice changes her published ESession options, the shorter the Perfect Forward Secrecy window of vulnerability. However, whenever she changes them she divulges her presence to all the entities that are monitoring them.</p><p><a name="nt-id2261108" id="nt-id2261108">11</a>. XEP-0082: XMPP Date and Time Profiles &lt;<a href="http://www.xmpp.org/extensions/xep-0082.html">http://www.xmpp.org/extensions/xep-0082.html</a>&gt;.</p><p><a name="nt-id2261206" id="nt-id2261206">12</a>. XEP-0163: Personal Eventing via Pubsub &lt;<a href="http://www.xmpp.org/extensions/xep-0163.html">http://www.xmpp.org/extensions/xep-0163.html</a>&gt;.</p><p><a name="nt-id2251043" id="nt-id2251043">13</a>. XEP-0189: Public Key Publishing &lt;<a href="http://www.xmpp.org/extensions/xep-0189.html">http://www.xmpp.org/extensions/xep-0189.html</a>&gt;.</p><p><a name="nt-id2251178" id="nt-id2251178">14</a>. There is no need for Bob to discover Alice's support for the Offline ESessions protocol via <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0030.html">Service Discovery</a></span>  [<a href="#nt-id2251074">15</a>].</p><p><a name="nt-id2251074" id="nt-id2251074">15</a>. XEP-0030: Service Discovery &lt;<a href="http://www.xmpp.org/extensions/xep-0030.html">http://www.xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-id2261967" id="nt-id2261967">16</a>. Alice may not be able to find the specified value of x if, for example, she went offline using a different client and/or a different machine without publishing a 'match_resource' field. In this case Alice cannot decrypt the offline ESession!</p><p><a name="nt-id2262150" id="nt-id2262150">17</a>. XEP-0091: Delayed Delivery &lt;<a href="http://www.xmpp.org/extensions/xep-0091.html">http://www.xmpp.org/extensions/xep-0091.html</a>&gt;.</p><p><a name="nt-id2262363" id="nt-id2262363">18</a>. The online ESessions protocol forces both Alice and Bob to produce a signature of both their Diffie-Hellman keys together.</p><p><a name="nt-id2262452" id="nt-id2262452">19</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p><p><a name="nt-id2262541" id="nt-id2262541">20</a>. The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see &lt;<a href="http://www.xmpp.org/registrar/">http://www.xmpp.org/registrar/</a>&gt;.</p><p><a name="nt-id2262522" id="nt-id2262522">21</a>. XEP-0053: XMPP Registrar Function &lt;<a href="http://www.xmpp.org/extensions/xep-0053.html">http://www.xmpp.org/extensions/xep-0053.html</a>&gt;.</p></div><hr /><h2><a name="revs" id="revs"></a>Revision History</h2><div class="indent"><h4>Version 0.5 (2007-05-30)</h4><div class="indent"><p class="" style="">Added reference to Requirements for Encrypted Sessions; modified namespaces to reflect XMPP Registrar procedures regarding URN issuance.</p> (ip/psa)
    </div><h4>Version 0.4 (2006-11-27)</h4><div class="indent"><p class="" style="">Added disclosure field; changed namespace</p> (ip)
    </div><h4>Version 0.3 (2006-10-05)</h4><div class="indent"><p class="" style="">Replaced secure field with security field; changed otr field to list-single</p> (ip)
    </div><h4>Version 0.2 (2006-07-19)</h4><div class="indent"><p class="" style="">Removed public key IDs from Offline options; harmonised session termination with the protocol added to XEP-0155; renamed logging field to otr</p> (ip)
    </div><h4>Version 0.1 (2006-07-18)</h4><div class="indent"><p class="" style="">Initial version (extracted from XEP-0116 version 0.9).</p> (ip)
    </div></div><hr /><p>END</p></body></html>
