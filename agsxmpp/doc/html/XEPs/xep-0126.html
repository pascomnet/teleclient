<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0126: Invisibility</title><link rel="stylesheet" type="text/css" href="/xmpp.css" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><meta name="DC.Title" content="Invisibility" /><meta name="DC.Creator" content="Peter Saint-Andre" /><meta name="DC.Description" content="This specification defines best practices regarding implementation of invisible presence by means of XMPP privacy lists." /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2005-08-19" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0126" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright (c) 1999 - 2008 by the XMPP Standards Foundation (XSF)." /></head><body><h1>XEP-0126: Invisibility</h1><p>This specification defines best practices regarding implementation of invisible presence by means of XMPP privacy lists.</p><hr /><p style="color:green">NOTICE: This Informational specification defines a best practice or protocol profile that has been approved by the XMPP Council and/or the XSF Board of Directors. Implementations are encouraged and the best practice or protocol profile is appropriate for deployment in production systems.</p><hr /><h2>Document Information</h2><p class="indent">
            Series: <a href="http://www.xmpp.org/extensions/">XEP</a><br />
            Number: 0126<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status: 
            <a href="http://www.xmpp.org/extensions/xep-0001.html#states-Active">Active</a><br />
            Type:
            <a href="http://www.xmpp.org/extensions/xep-0001.html#types-Informational">Informational</a><br />
            Version: 1.1<br />
            Last Updated: 2005-08-19<br />
                Approving Body: <a href="http://www.xmpp.org/council/">XMPP Council</a><br />Dependencies: XMPP Core, XMPP IM<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: N/A<br />
              Wiki Page: &lt;<a href="http://wiki.jabber.org/index.php/Invisibility (XEP-0126)">http://wiki.jabber.org/index.php/Invisibility (XEP-0126)</a>&gt;
            </p><hr /><h2>Author Information</h2><div class="indent"><h3>Peter Saint-Andre</h3><p class="indent">
        JabberID: 
        <a href="xmpp:stpeter@jabber.org">stpeter@jabber.org</a><br />
        URI: 
        <a href="https://stpeter.im/">https://stpeter.im/</a><br /></p></div><hr /><h2>Legal Notices</h2><div class="indent"><h3>Copyright</h3>This XMPP Extension Protocol is copyright (c) 1999 - 2008 by the XMPP Standards Foundation (XSF).<h3>Permissions</h3>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h3>Disclaimer of Warranty</h3><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. In no event shall the XMPP Standards Foundation or the authors of this Specification be liable for any claim, damages, or other liability, whether in an action of contract, tort, or otherwise, arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification. ##</span><h3>Limitation of Liability</h3>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising out of the use or inability to use the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h3>IPR Conformance</h3>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which may be found at &lt;<a href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt; or obtained by writing to XSF, P.O. Box 1641, Denver, CO 80201 USA).</div><hr /><h2>Discussion Venue</h2><p class="indent">The preferred venue for discussion of this document is the Standards discussion list: &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">http://mail.jabber.org/mailman/listinfo/standards</a>&gt;.</p><p class="indent">Errata may be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><h2>Relation to XMPP</h2><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 3920) and XMPP IM (RFC 3921) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><h2>Conformance Terms</h2><p class="indent">The following keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#intro">Introduction</a><br />2.  <a href="#reqs">Requirements</a><br />3.  <a href="#usecases">Use Cases</a><br />   
      3.1.  <a href="#invis-login">Log In as Globally Invisible</a><br />   
      3.2.  <a href="#vis-select">Become Selectively Visible</a><br />      
      3.2.1.  <a href="#vis-select-jid">Becoming Visible by JID</a><br />      
      3.2.2.  <a href="#vis-select-roster">Becoming Visible by Roster Group</a><br />      
      3.2.3.  <a href="#vis-select-sub">Becoming Visible by Subscription Type</a><br />   
      3.3.  <a href="#vis-global">Become Globally Visible</a><br />   
      3.4.  <a href="#invis-select">Become Selectively Invisible</a><br />      
      3.4.1.  <a href="#invis-select-jid">Becoming Invisible by JID</a><br />      
      3.4.2.  <a href="#invis-select-roster">Becoming Invisible by Roster Group</a><br />      
      3.4.3.  <a href="#invis-select-sub">Becoming Invisible by Subscription Type</a><br />   
      3.5.  <a href="#invis-global">Become Globally Invisible</a><br />4.  <a href="#impl">Implementation Notes</a><br />5.  <a href="#security">Security Considerations</a><br />6.  <a href="#iana">IANA Considerations</a><br />7.  <a href="#registrar">XMPP Registrar Considerations</a><br />8.  <a href="#schema">XML Schema</a><br /><a href="#notes">Notes</a><br /><a href="#revs">Revision History</a></p></div><hr /><h2>1.
       <a name="intro" id="intro">Introduction</a></h2>
  <p class="" style="">Several popular instant messaging services implement a feature known as invisibility: the ability to remain online yet appear offline to some or all of one's contacts. A number of Jabber servers and clients have also implemented such a feature, using special values of the &lt;presence/&gt; element's 'type' attribute (e.g., &lt;presence type='invisible'/&gt;). Unfortunately, such implementations are not compliant with <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc3920">XMPP Core</a></span>  [<a href="#nt-id2252658">1</a>] and <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc3921">XMPP IM</a></span>  [<a href="#nt-id2252683">2</a>], which specify that only the 'type' attribute values defined in the XML schema for the 'jabber:client' and 'jabber:server' namespaces are allowed in XMPP (and those values do not include "invisible"). However, <span class="ref">RFC 3921</span> also defines a privacy lists protocol (i.e., the 'jabber:iq:privacy' namespace) that can be used to implement invisibility in an XMPP-compliant manner. This specification documents how to do just that.</p>
<h2>2.
       <a name="reqs" id="reqs">Requirements</a></h2>
  <p class="" style="">This document addresses the following requirements:</p>
  <ul class="" style="">
    <li class="" style="">Enable users to appear visible or invisible to some or all contacts at any time.</li>
    <li class="" style="">Enable users to selectively change visibility based on roster group, subscription state, or individual JID.</li>
    <li class="" style="">Do so in an XMPP-compliant manner.</li>
  </ul>
<h2>3.
       <a name="usecases" id="usecases">Use Cases</a></h2>
  <p class="" style="">This document addresses the following use cases:</p>
  <ol start="" class="" style="">
    <li class="" style="">Log In as Globally Invisible</li>
    <li class="" style="">Become Selectively Visible</li>
    <li class="" style="">Become Globally Visible</li>
    <li class="" style="">Become Selectively Invisible</li>
    <li class="" style="">Become Globally Invisible</li>
  </ol>
  <p class="" style="">These use cases are defined below in "chronological" order by following a scenario in which a user (1) logs in as invisible, (2) becomes selectively visible to certain contacts, (3) becomes visible to all contacts, (4) becomes selectively invisible to certain contacts, and finally (5) becomes invisible to all contacts.</p>
  <div class="indent"><h3>3.1 <a name="invis-login" id="invis-login">Log In as Globally Invisible</a></h3>
    <p class="" style="">If a user wants to log in as invisible, a certain order of events MUST be followed. Specifically, after authenticating but before sending initial presence, the user MUST define (if necessary) and set as active a privacy list that blocks all outbound presence notifications.</p>
    <p class="caption"><a name="example-1" id="example-1"></a>Example 1. User Defines and Sets Global Invisibility Privacy Rule</p><div class="indent"><pre>
... authentication / session establishment ...

&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='inv1'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='invisible'&gt;
      &lt;item action='deny' order='1'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;

&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active1'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active name='invisible'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">Naturally, the user could have defined this list during a previous session and could simply set the relevant list as active when logging in, rather than defining the list on login. Both steps are shown here for completeness.</p>
    <p class="" style="">The user may now send initial presence to the server.</p>
    <p class="caption"><a name="example-2" id="example-2"></a>Example 2. User Sends Initial Presence</p><div class="indent"><pre>
&lt;presence&gt;
  &lt;status&gt;I'm not really here, you understand!&lt;/status&gt;
&lt;/presence&gt;
    </pre></div>
    <p class="" style="">Even though the user has sent initial presence, that presence information will not be broadcasted to any of the user's contacts, since the active privacy list blocks all outbound presence notifications.</p>
  </div>
  <div class="indent"><h3>3.2 <a name="vis-select" id="vis-select">Become Selectively Visible</a></h3>
    <p class="" style="">Let us now suppose that the user tires of being globally invisible, and decides to become visible to some -- but not all -- contacts (not even famous magic rings possess this feature). The 'jabber:iq:privacy' namespace gives the user three options:</p>
    <ul class="" style="">
      <li class="" style="">become visible only to specific JIDs</li>
      <li class="" style="">become visible only to specific roster groups</li>
      <li class="" style="">become visible based on subscription state</li>
    </ul>
    <p class="" style="">Examples of these options are shown below.</p>
    <div class="indent"><h3>3.2.1 <a name="vis-select-jid" id="vis-select-jid">Becoming Visible by JID</a></h3>
      <p class="caption"><a name="example-3" id="example-3"></a>Example 3. User Defines and Sets Selective Visibility Privacy Rule (by JID)</p><div class="indent"><pre>
&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='inv2'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='visible-to-Frodo'&gt;
      &lt;item type='jid'
            value='frodo@tolkien.lit'
            action='allow'
            order='1'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
      &lt;item action='deny' order='2'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;

&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active2'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active name='visible-to-Frodo'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The foregoing privacy list blocks outbound presence notifications to every JID except one.</p>
      <p class="" style="">In order to ensure synchronization of presence notifications, the client SHOULD now re-send the user's presence for broadcasting to all contacts, which the active rule will block to all but the specified JID:</p>
      <p class="caption"><a name="example-4" id="example-4"></a>Example 4. Client Sends Available Presence</p><div class="indent"><pre>
&lt;presence&gt;
  &lt;status&gt;I'm not really here, you understand!&lt;/status&gt;
&lt;/presence&gt;
      </pre></div>
    </div>
    <div class="indent"><h3>3.2.2 <a name="vis-select-roster" id="vis-select-roster">Becoming Visible by Roster Group</a></h3>
      <p class="caption"><a name="example-5" id="example-5"></a>Example 5. User Defines and Sets Selective Visibility Privacy Rule (by Roster Group)</p><div class="indent"><pre>
&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='inv3'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='visible-to-Bagginses'&gt;
      &lt;item type='group'
            value='Bagginses'
            action='allow'
            order='1'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
      &lt;item action='deny' order='2'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;

&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active3'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active name='visible-to-Bagginses'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The foregoing privacy list blocks outbound presence notifications to every JID except those in a certain roster group. In order to ensure synchronization of presence notifications, the client SHOULD now re-send the user's presence for broadcasting to all contacts, which the active rule will block to all but those JIDs in the specified roster group:</p>
      <p class="caption"><a name="example-6" id="example-6"></a>Example 6. Client Sends Available Presence</p><div class="indent"><pre>
&lt;presence&gt;
  &lt;status&gt;I'm not really here, you understand!&lt;/status&gt;
&lt;/presence&gt;
      </pre></div>
    </div>
    <div class="indent"><h3>3.2.3 <a name="vis-select-sub" id="vis-select-sub">Becoming Visible by Subscription Type</a></h3>
      <p class="" style="">Becoming visible or invisible by subscription type is probably much less likely than becoming visible by JID or roster group; however, it is described here for the sake of completeness.</p>
      <p class="caption"><a name="example-7" id="example-7"></a>Example 7. User Defines and Sets Selective Visibility Privacy Rule (by Subscription State)</p><div class="indent"><pre>
&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='inv4'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='visible-to-both'&gt;
      &lt;item type='subscription'
            value='both'
            action='allow'
            order='1'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
      &lt;item action='deny' order='2'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;

&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active4'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active name='visible-to-both'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The foregoing privacy list blocks outbound presence notifications to every JID except those that are in the user's roster with a subscription type of "both".</p>
      <p class="" style="">In order to ensure synchronization of presence notifications, the client SHOULD now re-send the user's presence for broadcasting to all contacts, which the active rule will block to all but those JIDs with the specified subscription type:</p>
      <p class="caption"><a name="example-8" id="example-8"></a>Example 8. Client Sends Available Presence</p><div class="indent"><pre>
&lt;presence&gt;
  &lt;status&gt;I'm not really here, you understand!&lt;/status&gt;
&lt;/presence&gt;
      </pre></div>
    </div>
  </div>
  <div class="indent"><h3>3.3 <a name="vis-global" id="vis-global">Become Globally Visible</a></h3>
    <p class="" style="">Let us now suppose that the user wants to become visible to all those who are subscribed to his presence. This easy to do by defining and setting as active a new privacy list (here again, the privacy list may have been defined previously).</p>
    <p class="caption"><a name="example-9" id="example-9"></a>Example 9. User Defines and Sets Global Visibility Privacy Rule</p><div class="indent"><pre>
&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='inv5'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='visible'&gt;
      &lt;item action='allow' order='1'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;

&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active5'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active name='visible'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">Because globally allowing outbound presence notifications is most likely the default behavior of any server, a more straightforward way to become globally visible is to decline the use of any active rule (the equivalent, as it were, of taking off a magic invisibility ring):</p>
    <p class="caption"><a name="example-10" id="example-10"></a>Example 10. User Declines the Use of Any Active Rule</p><div class="indent"><pre>
&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active6'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">In order to ensure synchronization of presence notifications, the client SHOULD now re-send the user's presence for broadcasting to all contacts, which the active rule will block to all but the specified JID:</p>
    <p class="caption"><a name="example-11" id="example-11"></a>Example 11. Client Sends Available Presence</p><div class="indent"><pre>
&lt;presence&gt;
  &lt;status&gt;I'm back!&lt;/status&gt;
&lt;/presence&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>3.4 <a name="invis-select" id="invis-select">Become Selectively Invisible</a></h3>
    <p class="" style="">Let us now suppose that the user no longer wants to be globally visible, but desires to be invisible only to some -- but not all -- contacts. As with visibility, here again the 'jabber:iq:privacy' namespace gives the user three options:</p>
    <ul class="" style="">
      <li class="" style="">Become invisible only to specific JIDs</li>
      <li class="" style="">Become invisible only to specific roster groups</li>
      <li class="" style="">Become invisible based on subscription state</li>
    </ul>
    <p class="" style="">Examples of these options are shown below.</p>
    <p class="" style="">In general, the process for becoming selectively invisible is as follows:</p>
    <ol start="" class="" style="">
      <li class="" style="">Send unavailable presence to the server.</li>
      <li class="" style="">Define and set a privacy rule for selective invisibility.</li>
      <li class="" style="">Send available presence to the server.</li>
    </ol>
    <p class="" style="">This process is necessary so that the contacts covered by the rule will no longer see the user as available.</p>
    <div class="indent"><h3>3.4.1 <a name="invis-select-jid" id="invis-select-jid">Becoming Invisible by JID</a></h3>
      <p class="" style="">First, the user sends unavailable presence for broadcasting to all contacts:</p>
      <p class="caption"><a name="example-12" id="example-12"></a>Example 12. User Sends Unavailable Presence</p><div class="indent"><pre>
&lt;presence type='unavailable'/&gt;
      </pre></div>
      <p class="" style="">The server then broadcasts that presence to all of the user's contacts.</p>
      <p class="" style="">Second, the user defines and sets a privacy rule that allows selective invisibility:</p>
      <p class="caption"><a name="example-13" id="example-13"></a>Example 13. User Defines and Sets Selective Invisibility Privacy Rule (by JID)</p><div class="indent"><pre>
&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='inv6'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='invisible-to-Gandalf'&gt;
      &lt;item type='jid'
            value='gandalf@tolkien.lit'
            action='deny'
            order='1'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
      &lt;item action='allow' order='2'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;

&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active7'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active name='invisible-to-Gandalf'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The foregoing privacy list allows outbound presence notifications to every JID except one.</p>
      <p class="" style="">In order to appear selectively invisible, the client MUST now re-send the user's presence for broadcasting to all contacts, which the active rule will block to the specified JID:</p>
      <p class="caption"><a name="example-14" id="example-14"></a>Example 14. Client Sends Available Presence</p><div class="indent"><pre>
&lt;presence&gt;
  &lt;status&gt;I'm back!&lt;/status&gt;
&lt;/presence&gt;
      </pre></div>
    </div>
    <div class="indent"><h3>3.4.2 <a name="invis-select-roster" id="invis-select-roster">Becoming Invisible by Roster Group</a></h3>
      <p class="" style="">First, the user sends unavailable presence for broadcasting to all contacts:</p>
      <p class="caption"><a name="example-15" id="example-15"></a>Example 15. User Sends Unavailable Presence</p><div class="indent"><pre>
&lt;presence type='unavailable'/&gt;
      </pre></div>
      <p class="" style="">The server then broadcasts that presence to all of the user's contacts.</p>
      <p class="" style="">Second, the user defines and sets a privacy rule that allows selective invisibility:</p>
      <p class="caption"><a name="example-16" id="example-16"></a>Example 16. User Defines and Sets Selective Invisibility Privacy Rule (by Roster Group)</p><div class="indent"><pre>
&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='inv7'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='invisible-to-Wizards'&gt;
      &lt;item type='group'
            value='Wizards'
            action='deny'
            order='1'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
      &lt;item action='allow' order='2'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;

&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active8'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active name='invisible-to-Wizards'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The foregoing privacy list allows outbound presence notifications to every JID except those in a certain roster group.</p>
      <p class="" style="">In order to appear selectively invisible, the client MUST now re-send the user's presence for broadcasting to all contacts, which the active rule will block to those in the specified roster group:</p>
      <p class="caption"><a name="example-17" id="example-17"></a>Example 17. Client Sends Available Presence</p><div class="indent"><pre>
&lt;presence&gt;
  &lt;status&gt;I'm back!&lt;/status&gt;
&lt;/presence&gt;
      </pre></div>
    </div>
    <div class="indent"><h3>3.4.3 <a name="invis-select-sub" id="invis-select-sub">Becoming Invisible by Subscription Type</a></h3>
      <p class="" style="">Becoming visible or invisible by subscription type is probably much less likely than becoming visible by JID or roster group; however, it is described here for the sake of completeness.</p>
      <p class="" style="">First, the user sends unavailable presence for broadcasting to all contacts:</p>
      <p class="caption"><a name="example-18" id="example-18"></a>Example 18. User Sends Unavailable Presence</p><div class="indent"><pre>
&lt;presence type='unavailable'/&gt;
      </pre></div>
      <p class="" style="">The server then broadcasts that presence to all of the user's contacts.</p>
      <p class="" style="">Second, the user defines and sets a privacy rule that allows selective invisibility:</p>
      <p class="caption"><a name="example-19" id="example-19"></a>Example 19. User Defines and Sets Selective Invisibility Privacy Rule (by Subscription State)</p><div class="indent"><pre>
&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='inv8'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='invisible-to-from'&gt;
      &lt;item type='subscription'
            value='from'
            action='deny'
            order='1'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
      &lt;item action='allow' order='2'&gt;
        &lt;presence-out/&gt;
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;

&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active9'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active name='invisible-to-from'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The foregoing privacy list allows outbound presence notifications to every JID except those that are in the user's roster with a subscription type of "to".</p>
      <p class="" style="">In order to appear selectively invisible, the client MUST now re-send the user's presence for broadcasting to all contacts, which the active rule will block to those with the specified subscription type:</p>
      <p class="caption"><a name="example-20" id="example-20"></a>Example 20. Client Sends Available Presence</p><div class="indent"><pre>
&lt;presence&gt;
  &lt;status&gt;I'm back!&lt;/status&gt;
&lt;/presence&gt;
      </pre></div>
    </div>
  </div>
  <div class="indent"><h3>3.5 <a name="invis-global" id="invis-global">Become Globally Invisible</a></h3>
    <p class="" style="">In order to become globally invisible again, the user does the following.</p>
    <p class="" style="">First, the user sends unavailable presence for broadcasting to all contacts:</p>
    <p class="caption"><a name="example-21" id="example-21"></a>Example 21. User Sends Unavailable Presence</p><div class="indent"><pre>
&lt;presence type='unavailable'/&gt;
    </pre></div>
    <p class="" style="">Second, the user sets as active the global invisibility list previously defined:</p>
    <p class="caption"><a name="example-22" id="example-22"></a>Example 22. User Becomes Globally Invisible</p><div class="indent"><pre>
&lt;iq from='bilbo@tolkien.lit/shire' type='set' id='active10'&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;active name='invisible'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">In order to appear globally invisible, the client MUST now re-send the user's presence for broadcasting to all contacts, which the active rule will block to all contacts:</p>
      <p class="caption"><a name="example-23" id="example-23"></a>Example 23. Client Sends Available Presence</p><div class="indent"><pre>
&lt;presence&gt;
  &lt;status&gt;I'm not really here, you understand!&lt;/status&gt;
&lt;/presence&gt;
      </pre></div>
  </div>
<h2>4.
       <a name="impl" id="impl">Implementation Notes</a></h2>
  <p class="" style="">The foregoing text explains the protocol used to implement invisibility. Naturally, client developers will most likely want to hide these protocol details from the end user. For example, rather than forcing the end user to navigate the details of privacy list management, a client could simply provide a "Go Invisible" button that sets as active the appropriate privacy list.</p>
  <p class="" style="">Note well that the privacy lists used to implement invisibility SHOULD be active lists and <span class="em">not</span> the default list.</p>
  <p class="" style="">To help ensure cross-client compatibility, it is RECOMMENDED to use the privacy list names "visible" and "invisible" for simple global visibility and invisibility respectively. It is also RECOMMENDED to use list names of the form "visible-to-GroupName" and "invisible-to-JID" for simple lists that implement visibility or invisibility with regard to roster groups and JIDs. Obviously list names could become rather complex, such as "visible-to-Group1 Group2 Group3". Implementations MUST NOT attempt to derive semantic meaning from privacy list names; these recommendations are provided for ease of use only with regard to basic privacy lists related to visibility/invisibility.</p>
  <p class="" style="">In general it is probably easiest for users to become visible/invisible either globally or based on roster group, since these models are conceptually simple. Although, naturally, a client developer cannot tell users what to do, it probably best to encourage the use of conceptually simple models for privacy lists.</p>
  <p class="" style="">Privacy lists can become complex and must be carefully managed by clients. For example, let us imagine that the user is currently applying another active list unrelated to visibility (e.g., a list that blocks communications with a stalker); if the user then clicks "Go Invisible" and the client is not smart, it could overwrite the stalker blocking. Therefore, if the user has an active list that incorporates rules other than those related to visibility/invisibility, the client SHOULD either assume that visibility/invisibility is an overlay on the list currently in use (generating an appropriate privacy list that takes both into account) or prompt the user regarding their intentions. In the absence of privacy lists unrelated to visibility/invisibility, the client may proceed in a less cautious fashion.</p>
<h2>5.
       <a name="security" id="security">Security Considerations</a></h2>
  <p class="" style="">For security concerns related to privacy lists, refer to <span class="ref">RFC 3921</span>. Care must be taken regarding privacy lists, especially so that visibility/invisibility rules do not overwrite existing rules the user has set for the sake of security and privacy; for details, see the <a href="#impl">Implementation Notes</a> section of this document.</p>
  <p class="" style="">It is important to recognize that invisibility can be defeated without more advanced privacy lists than those defined above and an awareness of context on the part of a client. For example, if a user usually logs in as the same resource (e.g., "Home"), a contact can send an IQ request to that resource's full JID using <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0012.html">Last Activity</a></span>  [<a href="#nt-id2261897">3</a>], <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0030.html">Service Discovery</a></span>  [<a href="#nt-id2261923">4</a>], <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0090.html">Entity Time</a></span>  [<a href="#nt-id2261950">5</a>], or <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0092.html">Software Version</a></span>  [<a href="#nt-id2261975">6</a>] and receive a reply, thus providing information that reveals the user's availability. In addition, <span class="ref">Last Activity</span> requests sent by a subscribed contact to the user's bare JID will normally reveal the user's availability as well. To help ensure that the user's invisibility cannot be defeated in this way, the user's client SHOULD add IQ blocking to the relevant privacy list. Finally, the user's client SHOULD NOT return "is-composing" events as defined in <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0022.html">Message Events</a></span>  [<a href="#nt-id2262009">7</a>] or <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0085.html">Chat State Notifications</a></span>  [<a href="#nt-id2262029">8</a>].</p>
<h2>6.
       <a name="iana" id="iana">IANA Considerations</a></h2>
  <p class="" style="">This document requires no interaction with the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-id2262071">9</a>].</p>
<h2>7.
       <a name="registrar" id="registrar">XMPP Registrar Considerations</a></h2>
  <p class="" style="">No namespaces or parameters need to be registered with the <span class="ref" style=""><a href="http://www.xmpp.org/registrar/">XMPP Registrar</a></span>  [<a href="#nt-id2262110">10</a>] as a result of this specification.</p>
<h2>8.
       <a name="schema" id="schema">XML Schema</a></h2>
  <p class="" style="">The XML schema for the 'jabber:iq:privacy' namespace is defined in <span class="ref">RFC 3921</span>.</p>
<hr /><h2><a name="notes" id="notes"></a>Notes</h2><div class="indent"><p><a name="nt-id2252658" id="nt-id2252658">1</a>. RFC 3920: Extensible Messaging and Presence Protocol (XMPP): Core &lt;<a href="http://tools.ietf.org/html/rfc3920">http://tools.ietf.org/html/rfc3920</a>&gt;.</p><p><a name="nt-id2252683" id="nt-id2252683">2</a>. RFC 3921: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence &lt;<a href="http://tools.ietf.org/html/rfc3921">http://tools.ietf.org/html/rfc3921</a>&gt;.</p><p><a name="nt-id2261897" id="nt-id2261897">3</a>. XEP-0012: Last Activity &lt;<a href="http://www.xmpp.org/extensions/xep-0012.html">http://www.xmpp.org/extensions/xep-0012.html</a>&gt;.</p><p><a name="nt-id2261923" id="nt-id2261923">4</a>. XEP-0030: Service Discovery &lt;<a href="http://www.xmpp.org/extensions/xep-0030.html">http://www.xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-id2261950" id="nt-id2261950">5</a>. XEP-0090: Entity Time &lt;<a href="http://www.xmpp.org/extensions/xep-0090.html">http://www.xmpp.org/extensions/xep-0090.html</a>&gt;.</p><p><a name="nt-id2261975" id="nt-id2261975">6</a>. XEP-0092: Software Version &lt;<a href="http://www.xmpp.org/extensions/xep-0092.html">http://www.xmpp.org/extensions/xep-0092.html</a>&gt;.</p><p><a name="nt-id2262009" id="nt-id2262009">7</a>. XEP-0022: Message Events &lt;<a href="http://www.xmpp.org/extensions/xep-0022.html">http://www.xmpp.org/extensions/xep-0022.html</a>&gt;.</p><p><a name="nt-id2262029" id="nt-id2262029">8</a>. XEP-0085: Chat State Notifications &lt;<a href="http://www.xmpp.org/extensions/xep-0085.html">http://www.xmpp.org/extensions/xep-0085.html</a>&gt;.</p><p><a name="nt-id2262071" id="nt-id2262071">9</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p><p><a name="nt-id2262110" id="nt-id2262110">10</a>. The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see &lt;<a href="http://www.xmpp.org/registrar/">http://www.xmpp.org/registrar/</a>&gt;.</p></div><hr /><h2><a name="revs" id="revs"></a>Revision History</h2><div class="indent"><h4>Version 1.1 (2005-08-19)</h4><div class="indent">Corrected order of presence and IQ stanzas to ensure proper processing by server. (psa)
    </div><h4>Version 1.0 (2004-03-05)</h4><div class="indent">Per a vote of the Jabber Council, advanced status to Active. (psa)
    </div><h4>Version 0.4 (2004-02-10)</h4><div class="indent">Minor editorial clarifications. (psa)
    </div><h4>Version 0.3 (2004-01-22)</h4><div class="indent">Added client responsibility for sending last available or unavailable presence. (psa)
    </div><h4>Version 0.2 (2004-01-21)</h4><div class="indent">Added more detail to the Security Considerations. (psa)
    </div><h4>Version 0.1 (2004-01-08)</h4><div class="indent">Initial version. (psa)
    </div></div><hr /><p>END</p></body></html>
